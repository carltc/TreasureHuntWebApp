@page
@model TreasureHuntWebApp.Pages.ItsADungeonCrawl.MedievalDungeonModel
@{
    ViewData["Title"] = "MedievalDungeon";
}

@using Microsoft.AspNetCore.Http
@inject IHttpContextAccessor HttpContextAccessor


<script src="/lib/jquery/dist/jquery.js"></script>
<script type="text/javascript">
    $(document).ready(function () {
        $(".door").click(function () {
            var commandName = $(this).attr("value");
            var hiddenInput = $("input[name=door]");
            hiddenInput.val(commandName);
        });
        $(".weapon").click(function () {
            var commandName = $(this).attr("value");
            var hiddenInput = $("input[name=weapon]");
            hiddenInput.val(commandName);
        }); $("#mapLogo").click(function () {
            $content = $("#map");
            //open up the content needed - toggle the slide- if visible, slide up, if not slidedown.
            $content.slideToggle(500, function () {
                //execute this after slideToggle is done
                //change text of header based on visibility of content div
                //$content.text(function () {
                //change text based on condition
                //return $content.is(":visible") ? "Collapse" : "Expand";
                //});
            });

        });
    });
</script>

<table class="dungeonImageHeader">
    <tr>
        @{
            if (!String.IsNullOrEmpty(HttpContextAccessor.HttpContext.Session.GetString("Map")))
            {
                <td>
                    <img id="mapLogo" class="bit8Image flipH" style="height: 100%; padding: 5pt;" src="~/DungeonGraphics/map.png" />
                </td>
            }
        }
        <td>
            <img class="bit8Image flipH" style="width: 100%; padding: 5pt;" src="~/DungeonGraphics/torch.png" />
        </td>
        <td>
            <img class="bit8Image" style="width: 100%; padding: 5pt;" src="~/DungeonGraphics/shield.png" />
        </td>
        <td>
            <img class="bit8Image" style="width: 100%; padding: 5pt;" src="~/DungeonGraphics/torch.png" />
        </td>
        @{
            if (!String.IsNullOrEmpty(HttpContextAccessor.HttpContext.Session.GetString("Sword")))
            {
                <td>
                    <img class="bit8Image" style="height: 100%; padding: 5pt;" src="~/DungeonGraphics/sword.jpg" />
                </td>
            }
        }
    </tr>
</table>
@{
    if (!String.IsNullOrEmpty(HttpContextAccessor.HttpContext.Session.GetString("Map")))
    {
        <div id="map" style="display: none; text-align: center; margin: auto;">
            <img class="bit8Image" style="width: 60%; padding: 5pt;" src="~/DungeonGraphics/mapLarge-8bit.png" />
        </div>
    }
}
<br />
@{
    if (Model.Dungeon[0].ID == 23)
    {
        <div style="text-align: center; margin: auto;">
            <img class="bit8Image" style="width: 40%; padding: 5pt;" src="~/DungeonGraphics/klorg-8bit.png" />
        </div>
    }
    else
    if (Model.Dungeon[0].ID == 35)
    {
        <div style="text-align: center; margin: auto;">
            <img class="bit8Image" style="width: 40%; padding: 5pt;" src="~/DungeonGraphics/skeleton.jpg" />
        </div>
    }
}
<p style="text-align: center; width: 100%; max-width: 400px; margin: auto">
    @Html.DisplayFor(model => Model.Dungeon[0].Storyline)
</p>
<br />
<table style="width: 100%;">
    <tr style="max-width: 500px;">
        @{
            if (Model.Dungeon[0].Name == "Pit")
            {
                <td style="text-align: center;">
                    <form method="post">
                        <input type="hidden" name="door" alt="Submit" value="blank" />
                        <input type="image" src="~/DungeonGraphics/pit.jpg" alt="Submit" class="door portalImage bit8Image" value="1">
                    </form>
                </td>
                HttpContextAccessor.HttpContext.Session.Remove("Sword");
                HttpContextAccessor.HttpContext.Session.Remove("Map");
            }
            else if (Model.Dungeon[0].ItemID == 1 && String.IsNullOrEmpty(HttpContextAccessor.HttpContext.Session.GetString("Monster" + Model.Dungeon[0].ID)))
            {
                if (!String.IsNullOrEmpty(HttpContextAccessor.HttpContext.Session.GetString("Sword")))
                {
                    <td style="text-align: center;">
                        <form method="post">
                            <input type="hidden" name="door" alt="Submit" value="blank" />
                            <input type="hidden" name="sword" alt="Submit" value="1" />
                            <input type="image" src="~/DungeonGraphics/sword.jpg" alt="Submit" class="door portalImage bit8Image" value="@Html.DisplayFor(model => Model.Dungeon[0].ID)">
                        </form>
                    </td>
                }
                else
                {
                    <td style="text-align: center;">
                        <form method="post">
                            <input type="hidden" name="door" alt="Submit" value="blank" />
                            <input type="image" src="~/DungeonGraphics/fist.jpg" alt="Submit" class="door portalImage bit8Image" value="37">
                        </form>
                    </td>
                }
            }
            else if (Model.Dungeon[0].ID == 23)
            {
                <td style="text-align: center;">
                    <form method="post">
                        <input type="hidden" name="door" alt="Submit" value="blank" />
                        <input type="image" src="~/DungeonGraphics/collarPortal.png" alt="Submit" class="door portalImage bit8Image" value="0">
                    </form>
                </td>
            }
            else if (Model.Dungeon[0].ID == 37)
            {
                <td style="text-align: center;">
                    <form method="post">
                        <input type="hidden" name="door" alt="Submit" value="blank" />
                        <input type="image" src="~/DungeonGraphics/knockedOut.jpg" alt="Submit" class="door portalImage bit8Image" value="1">
                        <p>(Maybe a weapon could help you fight a way past this monster)</p>
                    </form>
                </td>
                HttpContextAccessor.HttpContext.Session.Remove("Sword");
                HttpContextAccessor.HttpContext.Session.Remove("Map");
            }
            else
            {
                if (Model.Dungeon[0].NorthID != 0)
                {
                    <td style="text-align: center;">
                        <form method="post">
                            <input type="hidden" name="door" alt="Submit" value="blank" />
                            <input type="image" src="~/DungeonGraphics/medievalDoor-8bit.png" alt="Submit" class="door portalImage bit8Image" value="@Html.DisplayFor(model => Model.Dungeon[0].NorthID)">
                        </form>
                    </td>
                }
                if (Model.Dungeon[0].EastID != 0)
                {
                    <td style="text-align: center;">
                        <form method="post">
                            <input type="hidden" name="door" alt="Submit" value="blank" />
                            <input type="image" src="~/DungeonGraphics/medievalDoor-8bit.png" alt="Submit" class="door portalImage bit8Image" value="@Html.DisplayFor(model => Model.Dungeon[0].EastID)">
                        </form>
                    </td>
                }
                if (Model.Dungeon[0].SouthID != 0)
                {
                    <td style="text-align: center;">
                        <form method="post">
                            <input type="hidden" name="door" alt="Submit" value="blank" />
                            <input type="image" src="~/DungeonGraphics/medievalDoor-8bit.png" alt="Submit" class="door portalImage bit8Image" value="@Html.DisplayFor(model => Model.Dungeon[0].SouthID)">
                        </form>
                    </td>
                }
                if (Model.Dungeon[0].WestID != 0)
                {
                    <td style="text-align: center;">
                        <form method="post">
                            <input type="hidden" name="door" alt="Submit" value="blank" />
                            <input type="image" src="~/DungeonGraphics/medievalDoor-8bit.png" alt="Submit" class="door portalImage bit8Image" value="@Html.DisplayFor(model => Model.Dungeon[0].WestID)">
                        </form>
                    </td>
                }
            }
        }
    </tr>
</table>

